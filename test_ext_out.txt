============================= test session starts =============================
platform win32 -- Python 3.12.2, pytest-7.4.4, pluggy-1.6.0 -- C:\Program Files\Python312\python.exe
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: D:\Donzio_testcase\donizo_engine
configfile: pyproject.toml
plugins: anyio-4.4.0, dash-3.1.1, Faker-22.0.0, hypothesis-6.151.6, asyncio-0.23.3, cov-4.1.0
asyncio: mode=Mode.STRICT
collecting ... collected 110 items

test_external.py::TestSupplierFreshnessBoundary::test_supplier_at_exactly_3600s_is_eligible PASSED [  0%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_at_3601s_is_expired PASSED [  1%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_at_exactly_0s_is_eligible PASSED [  2%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_freshness_resets_on_new_quote PASSED [  3%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_freshness_independent_per_item PASSED [  4%]
test_external.py::TestSupplierFreshnessBoundary::test_no_supplier_no_historic_produces_fallback PASSED [  5%]
test_external.py::TestSupplierFreshnessBoundary::test_only_expired_supplier_falls_to_historic PASSED [  6%]
test_external.py::TestSupplierFreshnessBoundary::test_historic_never_expires PASSED [  7%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_update_overwrites_old_price PASSED [  8%]
test_external.py::TestSupplierFreshnessBoundary::test_supplier_price_zero PASSED [  9%]
test_external.py::TestCircuitBreakerBoundary::test_exactly_150_percent_not_anomaly PASSED [ 10%]
test_external.py::TestCircuitBreakerBoundary::test_one_cent_over_150_is_anomaly PASSED [ 10%]
test_external.py::TestCircuitBreakerBoundary::test_circuit_breaker_with_tiny_supplier PASSED [ 11%]
test_external.py::TestCircuitBreakerBoundary::test_circuit_breaker_with_very_large_prices PASSED [ 12%]
test_external.py::TestCircuitBreakerBoundary::test_no_circuit_breaker_when_supplier_expired PASSED [ 13%]
test_external.py::TestCircuitBreakerBoundary::test_circuit_breaker_only_on_human_source PASSED [ 14%]
test_external.py::TestCircuitBreakerBoundary::test_circuit_breaker_with_rejected_outcome PASSED [ 15%]
test_external.py::TestCircuitBreakerBoundary::test_anomaly_prevents_item_state_creation PASSED [ 16%]
test_external.py::TestCircuitBreakerBoundary::test_anomaly_doesnt_corrupt_existing_state PASSED [ 17%]
test_external.py::TestCircuitBreakerBoundary::test_circuit_breaker_skipped_when_supplier_price_zero PASSED [ 18%]
test_external.py::TestCircuitBreakerBoundary::test_human_rejected_outcome_with_anomaly_price PASSED [ 19%]
test_external.py::TestCircuitBreakerBoundary::test_human_none_outcome_with_anomaly_price PASSED [ 20%]
test_external.py::TestDecayEdgeCases::test_decay_exactly_at_7_days PASSED [ 20%]
test_external.py::TestDecayEdgeCases::test_decay_at_7_days_plus_1 PASSED [ 21%]
test_external.py::TestDecayEdgeCases::test_decay_of_odd_bias PASSED      [ 22%]
test_external.py::TestDecayEdgeCases::test_decay_of_negative_bias PASSED [ 23%]
test_external.py::TestDecayEdgeCases::test_decay_of_negative_odd_bias PASSED [ 24%]
test_external.py::TestDecayEdgeCases::test_decay_of_1_cent_bias PASSED   [ 25%]
test_external.py::TestDecayEdgeCases::test_decay_of_zero_bias PASSED     [ 26%]
test_external.py::TestDecayEdgeCases::test_decay_does_not_modify_stored_bias PASSED [ 27%]
test_external.py::TestDecayEdgeCases::test_multiple_decay_periods PASSED [ 28%]
test_external.py::TestDecayEdgeCases::test_learning_after_decay_resets_timestamp PASSED [ 29%]
test_external.py::TestDecayEdgeCases::test_decay_with_very_large_gap PASSED [ 30%]
test_external.py::TestDecayEdgeCases::test_no_item_state_no_decay PASSED [ 30%]
test_external.py::TestLearningEdgeCases::test_learning_creates_item_state PASSED [ 31%]
test_external.py::TestLearningEdgeCases::test_negative_delta_learning PASSED [ 32%]
test_external.py::TestLearningEdgeCases::test_zero_delta_learning PASSED [ 33%]
test_external.py::TestLearningEdgeCases::test_exactly_5_deltas PASSED    [ 34%]
test_external.py::TestLearningEdgeCases::test_6th_delta_evicts_first PASSED [ 35%]
test_external.py::TestLearningEdgeCases::test_no_learning_without_supplier PASSED [ 36%]
test_external.py::TestLearningEdgeCases::test_no_learning_with_expired_supplier PASSED [ 37%]
test_external.py::TestLearningEdgeCases::test_rejected_human_never_learns PASSED [ 38%]
test_external.py::TestLearningEdgeCases::test_median_of_even_count PASSED [ 39%]
test_external.py::TestLearningEdgeCases::test_median_truncation_toward_zero PASSED [ 40%]
test_external.py::TestLearningEdgeCases::test_learning_updates_timestamp PASSED [ 40%]
test_external.py::TestLearningEdgeCases::test_learning_with_supplier_price_zero_does_not_learn PASSED [ 41%]
test_external.py::TestDecisionTreeEdgeCases::test_human_accepted_overrides_all PASSED [ 42%]
test_external.py::TestDecisionTreeEdgeCases::test_fallback_supplier_before_historic PASSED [ 43%]
test_external.py::TestDecisionTreeEdgeCases::test_historic_fallback_when_no_supplier PASSED [ 44%]
test_external.py::TestDecisionTreeEdgeCases::test_no_data_fallback_price_zero PASSED [ 45%]
test_external.py::TestDecisionTreeEdgeCases::test_human_none_outcome_uses_fallback PASSED [ 46%]
test_external.py::TestDecisionTreeEdgeCases::test_bias_applied_to_supplier_fallback PASSED [ 47%]
test_external.py::TestDecisionTreeEdgeCases::test_bias_applied_to_historic_fallback PASSED [ 48%]
test_external.py::TestDecisionTreeEdgeCases::test_negative_bias_reduces_price PASSED [ 49%]
test_external.py::TestDecisionTreeEdgeCases::test_negative_bias_can_make_price_negative PASSED [ 50%]
test_external.py::TestDecisionTreeEdgeCases::test_anomaly_falls_back_to_supplier PASSED [ 50%]
test_external.py::TestStateHashIntegrity::test_empty_state_has_deterministic_hash PASSED [ 51%]
test_external.py::TestStateHashIntegrity::test_hash_length_is_64 PASSED  [ 52%]
test_external.py::TestStateHashIntegrity::test_different_items_different_hashes PASSED [ 53%]
test_external.py::TestStateHashIntegrity::test_same_items_different_bias_different_hash PASSED [ 54%]
test_external.py::TestStateHashIntegrity::test_hash_excludes_state_hash_field PASSED [ 55%]
test_external.py::TestStateHashIntegrity::test_hash_after_every_event PASSED [ 56%]
test_external.py::TestStateHashIntegrity::test_item_ordering_doesnt_matter PASSED [ 57%]
test_external.py::TestStateHashIntegrity::test_save_and_load_round_trip PASSED [ 58%]
test_external.py::TestStateHashIntegrity::test_corrupt_state_detected PASSED [ 59%]
test_external.py::TestStateHashIntegrity::test_fresh_state_file_created_on_first_load PASSED [ 60%]
test_external.py::TestInputValidationExhaustive::test_duplicate_across_different_items PASSED [ 60%]
test_external.py::TestInputValidationExhaustive::test_duplicate_across_different_sources PASSED [ 61%]
test_external.py::TestInputValidationExhaustive::test_negative_price_exactly_minus_1 PASSED [ 62%]
test_external.py::TestInputValidationExhaustive::test_price_zero_is_valid PASSED [ 63%]
test_external.py::TestInputValidationExhaustive::test_supplier_with_accepted_outcome_raises PASSED [ 64%]
test_external.py::TestInputValidationExhaustive::test_supplier_with_rejected_outcome_raises PASSED [ 65%]
test_external.py::TestInputValidationExhaustive::test_historic_with_accepted_outcome_raises PASSED [ 66%]
test_external.py::TestInputValidationExhaustive::test_invalid_source_raises PASSED [ 67%]
test_external.py::TestInputValidationExhaustive::test_invalid_outcome_raises PASSED [ 68%]
test_external.py::TestInputValidationExhaustive::test_float_price_raises PASSED [ 69%]
test_external.py::TestInputValidationExhaustive::test_large_price_is_valid PASSED [ 70%]
test_external.py::TestInputValidationExhaustive::test_event_count_in_error_message PASSED [ 70%]
test_external.py::TestMultiItem::test_items_have_independent_bias PASSED [ 71%]
test_external.py::TestMultiItem::test_items_have_independent_decay PASSED [ 72%]
test_external.py::TestMultiItem::test_many_items_hash_stability PASSED   [ 73%]
test_external.py::TestMultiItem::test_historic_updates_dont_create_item_state PASSED [ 74%]
test_external.py::TestMultiItem::test_supplier_updates_dont_create_item_state PASSED [ 75%]
test_external.py::TestMultiItem::test_sequential_items_dont_leak_cache PASSED [ 76%]
test_external.py::TestMultiItem::test_1000_events_single_item PASSED     [ 77%]
test_external.py::TestMultiItem::test_interleaved_items_maintain_isolation PASSED [ 78%]
test_external.py::TestMedianEdgeCases::test_empty PASSED                 [ 79%]
test_external.py::TestMedianEdgeCases::test_single_zero PASSED           [ 80%]
test_external.py::TestMedianEdgeCases::test_single_negative PASSED       [ 80%]
test_external.py::TestMedianEdgeCases::test_two_values PASSED            [ 81%]
test_external.py::TestMedianEdgeCases::test_three_identical PASSED       [ 82%]
test_external.py::TestMedianEdgeCases::test_five_sorted PASSED           [ 83%]
test_external.py::TestMedianEdgeCases::test_five_reverse PASSED          [ 84%]
test_external.py::TestMedianEdgeCases::test_large_values PASSED          [ 85%]
test_external.py::TestAuditRecordCorrectness::test_event_id_matches PASSED [ 86%]
test_external.py::TestAuditRecordCorrectness::test_timestamp_matches PASSED [ 87%]
test_external.py::TestAuditRecordCorrectness::test_item_id_matches PASSED [ 88%]
test_external.py::TestAuditRecordCorrectness::test_inputs_seen_supplier_null_when_absent PASSED [ 89%]
test_external.py::TestAuditRecordCorrectness::test_inputs_seen_human_null_when_absent PASSED [ 90%]
test_external.py::TestAuditRecordCorrectness::test_inputs_seen_shows_human_when_present PASSED [ 90%]
test_external.py::TestAuditRecordCorrectness::test_flags_empty_for_standard_query PASSED [ 91%]
test_external.py::TestAuditRecordCorrectness::test_final_price_is_int_type PASSED [ 92%]
test_external.py::TestAuditRecordCorrectness::test_bias_applied_is_int_type PASSED [ 93%]
test_external.py::TestAuditRecordCorrectness::test_rules_hash_is_sha256 PASSED [ 94%]
test_external.py::TestFileLevel::test_replay_with_empty_events PASSED    [ 95%]
test_external.py::TestFileLevel::test_single_event_replay PASSED         [ 96%]
test_external.py::TestFileLevel::test_bad_json_line_raises PASSED        [ 97%]
test_external.py::TestFileLevel::test_missing_field_raises PASSED        [ 98%]
test_external.py::TestFileLevel::test_blank_lines_ignored PASSED         [ 99%]
test_external.py::TestFileLevel::test_audit_log_line_count PASSED        [100%]

============================= 110 passed in 0.62s =============================
